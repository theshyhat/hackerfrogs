# URL
# Concept
* malware analysis
# Method of solve
* in the AttackBox, open a terminal, then run this command to open the malware file in a text editor:
```
pluma /root/Rooms/AoC2025/Day21/survey.hta
```
## Q1 - What is the title of the HTA application?
* observe the title on line 4 of the file
## Q2 - What VBScript function is acting as if it is downloading the survey questions?
* the answer is on line 43 of the file
## Q3 - What URL domain (including sub-domain) is the "questions" being downloaded from?
* the answer is on line 46 (there is a spelling mistake in the domain name)
## Q4 - Malhare seems to be using typosquatting, domains that look the same as the real one, in an attempt to hide the fact that the domain is not the inteded one, what character in the domain gives this away?
* the domain from the previous question has a repeated letter as a typo. That letter is answer
## Q5 - Malicious HTAs often include real-looking data, like survey questions, to make the file seem authentic. How many questions does the survey have?
* the answer is `4`
## Q6 - Notice how even in code, social engineering persists, fake incentives like contests or trips hide in plain sight to build trust. The survey entices participation by promising a chance to win a trip to where?
* the answer is on line 215
## Q7 - The HTA is enumerating information from the local host executing the application. What two pieces of information about the computer it is running on are being exfiltrated? You should provide the two object names separated by commas.
* the answer is on lines 60 and 61
## Q8 - What endpoint is the enumerated data being exfiltrated to?
* the answer is on line 65
## Q9 - What HTTP method is being used to exfiltrate the data?
* the function in question is sent with URL parameters, which points to a `GET` request
## Q10 - After reviewing the function intended to get the survey questions, it seems that the data from the download of the questions is actually being executed. What is the line of code that executes the contents of the download?
* the entire line of line 73 is the answer
## Q11 - It seems as if the malware site has been taken down, so we cannot download the contents that the malware was executing. Fortunately, one of the elves created a copy when the site was still active. Download the contents from here. What popular encoding scheme was used in an attempt to obfuscate the download?
* look at the content of this file in the web browser:
```
https://assets.tryhackme.com/additional/aoc2025/files/blob.txt
```
* it looks like base64 encoding
## Q12 - Decode the payload. It seems as if additional steps where taken to hide the malware! What common encryption scheme was used in the script?
* copy the payload in the txt file and paste it into a website like `https://www.base64decode.org/`
* the decoded script looks like it's doing a `ROT13` encode / decode on a string
## Q13 - Either run the script or decrypt the flag value using online tools such as CyberChef. What is the flag value?
* copy the `$flag` variable value, then paste it into a website like `https://rot13.com`
