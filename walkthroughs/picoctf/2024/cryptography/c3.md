# URL
# Concept
* reverse engineering
# Method of solve
## Part 1 - Decrypting the *first* file
* we download two files, the ciphertext file and the script that was used to encrypted the ciphertext file, with this code:
```
import sys
chars = ""
from fileinput import input
for line in input():
  chars += line

lookup1 = "\n \"#()*+/1:=[]abcdefghijklmnopqrstuvwxyz"
lookup2 = "ABCDEFGHIJKLMNOPQRSTabcdefghijklmnopqrst"

out = ""

prev = 0
for char in chars:
  cur = lookup1.index(char)
  out += lookup2[(cur - prev) % 40]
  prev = cur

sys.stdout.write(out)
```
* the code populates the `chars` string with the contents of the plaintext file
* then it runs through a for loop on the `chars` string, finding the index of the letter in the `loopup1` string, then substracting the `prev` (previous index) from the current index (`cur`) and taking the modulus of 40
```
prev = 0
for char in chars:
  cur = lookup1.index(char)
  out += lookup2[(cur - prev) % 40]
  prev = cur
```
* so we can reverse the operations in the code to decrypt the ciphertext file
* first we flip the lookup strings for the `cur` and the `out` variables
```
prev = 0
for char in chars:
  cur = lookup2.index(char)
  out += lookup1
```
* since the previous script did `cur - prev`, we reverse this by running `cur + prev`, then modulo the result by 40
```
  out += lookup1[(cur + prev) % 40]
```
The full decryption script looks like this:
```
import sys
chars = ""
from fileinput import input
for line in input():
  chars += line

lookup1 = "\n \"#()*+/1:=[]abcdefghijklmnopqrstuvwxyz"
lookup2 = "ABCDEFGHIJKLMNOPQRSTabcdefghijklmnopqrst"

out = ""

prev = 0
for char in chars:
  cur = lookup2.index(char)
  offset = (cur + prev) % 40
  out += lookup1[offset]
  prev = offset

sys.stdout.write(out)
```
## Part 2 - Decrypting the *second* file
* the decryption process produces a second script with these contents:
```
#asciiorder
#fortychars
#selfinput
#pythontwo

chars = ""
from fileinput import input
for line in input():
    chars += line
b = 1 / 1

for i in range(len(chars)):
    if i == b * b * b:
        print chars[i] #prints
        b += 1 / 1
```
* the script comments indicate that this script should be run with Python version 2, so we run it with the script itself (since we tried it with the ciphertext and the convert.py script and it didn't return a valid flag)
```
python2 new_script.py new_script.py
```

